# 飞书多维表格助手

一个基于 **React + TypeScript + Vite** 的轻量级 Web 工具，用于：

- 导入 Excel/CSV，自动识别字段、推断类型并可追加导入；
- 配置飞书多维表字段要求（字段类型、必填校验、可选项、值映射、文本固定位数等）；
- 映射生成新表、在线编辑并实时校验；
- 一键复制为富文本/TSV（可选是否包含表头），或导出 Markdown / HTML 文档、CSV、Excel；
- 对 `教育id` 自动去重，避免重复记录；
- 支持文本字段固定位数（不足位数自动补 0），值映射可自定义脚本式替换；
- 复制、导出操作均有 Toast 提示，避免重复操作。

## 目录结构

```
fe-multidim-tool/
├── src/
│   ├── App.tsx          主要业务逻辑 & 页面
│   ├── App.css          页面样式
│   ├── main.tsx         React 入口
│   └── ...
├── public/              静态资源
├── package.json
├── README.md            当前文档
└── ...
```

## 快速开始

```bash
# 安装依赖
npm install

# 开发调试
npm run dev

# 打包构建
npm run build
```

浏览器访问 `http://localhost:5173`（Vite 默认端口）即可使用。

## 主要功能说明

| 功能 | 说明 |
| --- | --- |
| 导入方式 | 支持 Excel/CSV，首行做表头，可覆盖导入或追加导入；自动去除空白列、保留字段顺序 |
| 字段配置 | 字段名、类型、来源列、必填、可选项、值映射、文本固定位数等可视化配置 |
| 自动去重 | 以 `教育id` 为主键，映射前自动过滤重复数据 |
| 文本固定位数 | 可为文本字段设定目标位数，映射/编辑时自动 `padStart` 补 0 |
| 值映射 | 支持多个“原值 → 目标值”规则，例如角色 S/T → 学生/老师 |
| 映射编辑 | 生成数据后可直接在表格内编辑，实时校验并展示错误行/错误原因 |
| 一键复制 | 可选是否带表头，同时复制富文本和 TSV，方便粘贴到 Excel / 飞书 |
| 导出 | Markdown、HTML、CSV、Excel；导出 CSV/Excel 后提供 Toast 提示 |
| 提示机制 | 状态栏 + Toast 双提示，复制/下载等操作均有明确反馈 |

## 技术栈

- React 19 + TypeScript 5
- Vite 7
- XLSX（SheetJS）用于解析/导出 Excel
- 自定义 Hooks/工具函数，未引入额外状态管理库

## 常见问题

1. **字段识别不准确？**  
   请确认首行表头每个单元格都包含真实文本，且未被合并；工具会自动扩展 `!ref`，无需手动调整范围。

2. **导出 Excel 失败？**  
   确认浏览器允许下载文件；若数据量过大，可先导出 CSV。

3. **如何修改默认字段？**  
   默认保留姓名、教育id、密码（登录验证码）、身份（角色）。可在 `DEFAULT_FIELD_CONFIGS` 中调整规则或顺序。

## 开发者说明

- 项目以 Vite 官方模板为基础，按需保留 ESLint/TSConfig。
- 如需启用 React Compiler 或更严格的 lint，可参考 Vite 官方文档在 `vite.config.ts`、`eslint.config.js` 中自定义。
- 如果计划部署生产环境，请自行配置 HTTPS、鉴权等安全策略。

欢迎在此基础上继续扩展，例如接入后端接口、保存配置模板、批量通知等。祝使用愉快！*** End Patch
